<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <title>–ú–æ—è –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞</title> 
    <style>
        /* === –°—Ç–∏–ª—ñ–∑–∞—Ü—ñ—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏ === */
        body { 
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; 
            margin: 0; 
            padding: 0; 
            display: flex; 
            flex-direction: column; 
            min-height: 100vh; 
            background-color: #f4f4f9; /* –°–≤—ñ—Ç–ª–∏–π —Ñ–æ–Ω */
        }

        /* –°—Ç–∏–ª—å –¥–ª—è —à–∞–ø–∫–∏ —Ç–∞ –ø—ñ–¥–≤–∞–ª—É */
        header, footer { 
            background: #2c3e50; 
            color: #fff; 
            text-align: center; 
            padding: 1rem; 
        }

        /* –û—Å–Ω–æ–≤–Ω–∏–π –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä –ø–æ —Ü–µ–Ω—Ç—Ä—É */
        main { 
            flex: 1; 
            padding: 2em; 
            max-width: 600px; 
            margin: auto; 
            background: white;
            box-shadow: 0 0 10px rgba(0,0,0,0.1);
            width: 100%;
        }

        /* –°—Ç–∏–ª—å —Ñ–æ—Ä–º–∏ –¥–æ–¥–∞–≤–∞–Ω–Ω—è */
        form { display: flex; gap: 10px; margin-bottom: 20px; }
        
        input { 
            flex: 1; 
            padding: 10px; 
            border: 1px solid #ddd; 
            border-radius: 4px;
        }

        /* –ö–Ω–æ–ø–∫–∞ –¥–æ–¥–∞–≤–∞–Ω–Ω—è (–∑–µ–ª–µ–Ω–∞) */
        button[type="submit"] {
            padding: 10px 20px;
            background-color: #27ae60;
            color: white;
            border: none;
            cursor: pointer;
            border-radius: 4px;
        }

        ul { list-style: none; padding: 0; }

        /* –°—Ç–∏–ª—å –∫–æ–∂–Ω–æ–≥–æ —Ä—è–¥–∫–∞ (–∫–Ω–∏–≥–∏) */
        li { 
            border-bottom: 1px solid #eee; 
            padding: 10px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
        }

        /* –ö–Ω–æ–ø–∫–∞ –≤–∏–¥–∞–ª–µ–Ω–Ω—è (—á–µ—Ä–≤–æ–Ω–∞) */
        .delete-btn { 
            background-color: #e74c3c; 
            color: white; 
            border: none; 
            padding: 5px 10px; 
            border-radius: 4px;
            cursor: pointer;
            margin-left: 10px;
        }
    </style>
</head>
<body>

    <header>
        <h1>üìö –ú–æ—è –ë—ñ–±–ª—ñ–æ—Ç–µ–∫–∞</h1>
        <p>–°–ø–∏—Å–æ–∫ –∫–Ω–∏–≥ –¥–ª—è –ø—Ä–æ—á–∏—Ç–∞–Ω–Ω—è</p>
    </header>

    <main>
        <form id="addForm">
            <input type="text" id="itemInput" placeholder="–í–≤–µ–¥—ñ—Ç—å –Ω–∞–∑–≤—É –∫–Ω–∏–≥–∏..." required>
            <button type="submit">–î–æ–¥–∞—Ç–∏ –∫–Ω–∏–≥—É</button>
        </form>

        <ul id="itemsList"></ul>
    </main>

    <footer>
        <p>¬© 2025 Library App Project</p>
    </footer>

    <script>
        // –ê–¥—Ä–µ—Å–∞ –Ω–∞—à–æ–≥–æ Backend API (–ø–æ—Ä—Ç 3000)
        const API = "http://localhost:3000/api/items";
        
        // –û—Ç—Ä–∏–º—É—î–º–æ –µ–ª–µ–º–µ–Ω—Ç–∏ –∑—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏ –¥–ª—è —Ä–æ–±–æ—Ç–∏ –∑ –Ω–∏–º–∏
        const list = document.getElementById('itemsList');
        const form = document.getElementById('addForm');
        const input = document.getElementById('itemInput');

        // --- –§—É–Ω–∫—Ü—ñ—è: –ó–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å–ø–∏—Å–∫—É (READ) ---
        async function loadItems() {
            list.innerHTML = ""; // –û—á–∏—â–∞—î–º–æ —Å–ø–∏—Å–æ–∫ –ø–µ—Ä–µ–¥ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º
            
            // –†–æ–±–∏–º–æ –∑–∞–ø–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            const res = await fetch(API);
            const items = await res.json(); // –ü–µ—Ä–µ—Ç–≤–æ—Ä—é—î–º–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—å —É JSON
            
            // –î–ª—è –∫–æ–∂–Ω–æ–≥–æ –µ–ª–µ–º–µ–Ω—Ç–∞ –º–∞—Å–∏–≤—É –≤–∏–∫–ª–∏–∫–∞—î–º–æ —Ñ—É–Ω–∫—Ü—ñ—é –º–∞–ª—é–≤–∞–Ω–Ω—è
            items.forEach(item => addItemToDOM(item));
        }

        // --- –§—É–Ω–∫—Ü—ñ—è: –í—ñ–¥–æ–±—Ä–∞–∂–µ–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç–∞ –Ω–∞ —Å—Ç–æ—Ä—ñ–Ω—Ü—ñ ---
        function addItemToDOM(item) {
            const li = document.createElement('li');
            
            // –§–æ—Ä–º—É—î–º–æ HTML –¥–ª—è –æ–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞
            // onblur="updateItem..." –≤–∏–∫–ª–∏–∫–∞—î—Ç—å—Å—è, –∫–æ–ª–∏ –º–∏ –∑–∞–∫—ñ–Ω—á–∏–ª–∏ —Ä–µ–¥–∞–≥—É–≤–∞—Ç–∏ —Ç–µ–∫—Å—Ç
            li.innerHTML = `
                <span contenteditable="true" onblur="updateItem(${item.id}, this.innerText)">
                    ${item.text || ''}
                </span>
                <div class="actions">
                    <button class="delete-btn" onclick="deleteItem(${item.id})">–í–∏–¥–∞–ª–∏—Ç–∏</button>
                </div>
            `;
            list.appendChild(li);
        }

        // --- –ü–æ–¥—ñ—è: –î–æ–¥–∞–≤–∞–Ω–Ω—è –Ω–æ–≤–æ–≥–æ –∑–∞–ø–∏—Å—É (CREATE) ---
        form.addEventListener('submit', async (e) => {
            e.preventDefault(); // –ó—É–ø–∏–Ω—è—î–º–æ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–µ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è —Å—Ç–æ—Ä—ñ–Ω–∫–∏
            
            const text = input.value.trim();
            if (!text) return; // –Ø–∫—â–æ –ø–æ–ª–µ –ø–æ—Ä–æ–∂–Ω—î, –Ω—ñ—á–æ–≥–æ –Ω–µ —Ä–æ–±–∏–º–æ

            // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ POST –∑–∞–ø–∏—Ç –Ω–∞ —Å–µ—Ä–≤–µ—Ä
            const res = await fetch(API, {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ text }) // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ –æ–±'—î–∫—Ç { text: "–ù–∞–∑–≤–∞ –∫–Ω–∏–≥–∏" }
            });

            const newItem = await res.json(); // –û—Ç—Ä–∏–º—É—î–º–æ —Å—Ç–≤–æ—Ä–µ–Ω–∏–π –æ–±'—î–∫—Ç –≤—ñ–¥ —Å–µ—Ä–≤–µ—Ä–∞
            addItemToDOM(newItem); // –î–æ–¥–∞—î–º–æ –π–æ–≥–æ –Ω–∞ –µ–∫—Ä–∞–Ω
            input.value = ""; // –û—á–∏—â–∞—î–º–æ –ø–æ–ª–µ –≤–≤–æ–¥—É
        });

        // --- –§—É–Ω–∫—Ü—ñ—è: –û–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ø–∏—Å—É (UPDATE) ---
        async function updateItem(id, text) {
            // –í—ñ–¥–ø—Ä–∞–≤–ª—è—î–º–æ PUT –∑–∞–ø–∏—Ç –∑ –Ω–æ–≤–∏–º —Ç–µ–∫—Å—Ç–æ–º
            await fetch(`${API}/${id}`, {
                method: "PUT",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ text })
            });
            console.log(`–ö–Ω–∏–≥–∞ –∑ ID ${id} –æ–Ω–æ–≤–ª–µ–Ω–∞`);
        }

        // --- –§—É–Ω–∫—Ü—ñ—è: –í–∏–¥–∞–ª–µ–Ω–Ω—è –∑–∞–ø–∏—Å—É (DELETE) ---
        async function deleteItem(id) {
            if(confirm("–í–∏ –≤–ø–µ–≤–Ω–µ–Ω—ñ, —â–æ —Ö–æ—á–µ—Ç–µ –≤–∏–¥–∞–ª–∏—Ç–∏ —Ü—é –∫–Ω–∏–≥—É?")) {
                await fetch(`${API}/${id}`, { method: "DELETE" });
                loadItems(); // –ü–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—É—î–º–æ —Å–ø–∏—Å–æ–∫ –ø—ñ—Å–ª—è –≤–∏–¥–∞–ª–µ–Ω–Ω—è
            }
        }

        // –ó–∞–ø—É—Å–∫ —Ñ—É–Ω–∫—Ü—ñ—ó –ø—Ä–∏ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏
        loadItems();
    </script>
</body>
</html>